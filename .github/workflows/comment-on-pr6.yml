name: Comment on PR #6
on:
  workflow_dispatch:
  push:
    branches:
      - copilot/fix-f99f8933-db63-4dbf-aee8-6caf44f487f8
    paths:
      - '.github/workflows/comment-on-pr6.yml'

permissions:
  pull-requests: write
  contents: read

jobs:
  comment-on-pr:
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/copilot/fix-f99f8933-db63-4dbf-aee8-6caf44f487f8'
    steps:
      - name: Post comment on PR #6
        uses: actions/github-script@v7
        with:
          script: |
            const prNumber = 6;
            
            const commentLines = [
              "## 🔍 PR Analysis & Merge Conflict Resolution",
              "",
              "Thank you for the Flask dependency update, @dependabot!",
              "",
              "### Current Status",
              "This PR attempts to update Flask from 2.0.3 to 2.2.5, but there appears to be a merge conflict with the current requirements.txt file.",
              "",
              "### Issue Identified",
              "- **PR changes**: Updates Flask 2.0.3 → 2.2.5 and related dependencies",
              "- **Main branch**: Currently uses FastAPI-based dependencies",
              "- **Conflict**: The main branch has evolved to use FastAPI instead of Flask",
              "",
              "### Recommended Actions",
              "1. **For maintainers**:",
              "   - This PR may be outdated since the project has migrated from Flask to FastAPI",
              "   - Consider closing this PR if Flask is no longer used",
              "   - Review if any Flask dependencies are still needed alongside FastAPI",
              "",
              "2. **Alternative approach**:",
              "   - If Flask is still needed for specific components, manually merge the required Flask dependencies",
              "   - Update the requirements.txt to include both Flask and FastAPI dependencies if both are needed",
              "",
              "### Dependencies Comparison",
              "**PR #6 suggests:**",
              "```",
              "Flask==2.2.5",
              "Werkzeug>=2.2.3",
              "Jinja2>=3.1.2",
              "click>=8.0",
              "itsdangerous>=2.1.2",
              "requests==2.32.4",
              "```",
              "",
              "**Current main branch:**",
              "```",
              "fastapi>=0.104.1",
              "uvicorn[standard]>=0.24.0",
              "pydantic>=2.5.0",
              "python-multipart>=0.0.6",
              "requests>=2.31.0",
              "python-dotenv>=1.0.0",
              "```",
              "",
              "Would you like me to help resolve this by either:",
              "- Closing this PR if Flask is no longer needed",
              "- Creating a new PR that properly merges Flask dependencies with the current FastAPI setup",
              "",
              "---",
              "*This comment was automatically generated to help with PR triage and conflict resolution.*"
            ];
            
            const comment = commentLines.join("\n");

            try {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: prNumber,
                body: comment
              });
              console.log('Successfully posted comment on PR #6');
            } catch (error) {
              console.error('Failed to post comment:', error);
              throw error;
            }